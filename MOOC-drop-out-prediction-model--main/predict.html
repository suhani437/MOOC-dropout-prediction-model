<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Predict - MOOC Risk Predictor</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
body { font-family: 'Poppins', sans-serif; background: linear-gradient(135deg,#74b9ff,#a29bfe); color:#fff; min-height:100vh; }
.container { margin-top:50px; margin-bottom:50px; }
.card { background: rgba(0,0,0,0.5); border:none; border-radius:12px; padding:20px; }
input { margin-bottom:10px; }
input.is-invalid { border-color: #dc3545; background-color: #f8d7da; color: #721c24; }
.btn-home { margin-bottom: 20px; }
</style>
</head>
<body>
<div class="container">
    <a href="{{ url_for('index') }}" class="btn btn-outline-light btn-home">Home</a>
    
    <h2>Enter Student Data for Prediction</h2>
    <div class="card">
        <form method="POST" id="predictForm">
            <label>Total Activity [1-100]:</label>
            <input type="number" name="total_activity" class="form-control" min="1" max="100" required>

            <label>Early+Mid+Late Events [0-100]:</label>
            <input type="number" name="early_mid_late" class="form-control" min="0" max="100">

            <label>Active Days [1-30]:</label>
            <input type="number" name="active_days" class="form-control" min="1" max="30" required>

            <label>Activity Duration [0-1000]:</label>
            <input type="number" name="activity_duration" class="form-control" min="0" max="1000">

            <label>Video [0-50]:</label>
            <input type="number" name="video" class="form-control" min="0" max="50">

            <label>Discussion [0-50]:</label>
            <input type="number" name="discussion" class="form-control" min="0" max="50">

            <label>Problem [0-50]:</label>
            <input type="number" name="problem" class="form-control" min="0" max="50">

            <button type="submit" class="btn btn-primary mt-2">Predict</button>
        </form>

        {% if error %}
        <div class="alert alert-danger mt-3">{{ error }}</div>
        {% endif %}
        {% if prediction %}
        <div class="alert alert-success mt-3">Prediction: {{ prediction }}</div>

        <!-- Chart for Entered Data -->
        <canvas id="featureChart" width="400" height="200" class="mt-4"></canvas>
        <script>
        const ctx = document.getElementById('featureChart').getContext('2d');
        const data = {
            labels: ['Total Activity','Early+Mid+Late','Active Days','Activity Duration','Video','Discussion','Problem'],
            datasets: [{
                label: 'Entered Feature Values',
                data: [
                    {{ request.form['total_activity'] }},
                    {{ request.form['early_mid_late'] or 0 }},
                    {{ request.form['active_days'] }},
                    {{ request.form['activity_duration'] or 0 }},
                    {{ request.form['video'] or 0 }},
                    {{ request.form['discussion'] or 0 }},
                    {{ request.form['problem'] or 0 }}
                ],
                backgroundColor: '#2ecc71',
                borderRadius: 5
            }]
        };

        new Chart(ctx, {
            type: 'bar',
            data: data,
            options: {
                responsive: true,
                plugins: {
                    legend: { display: false },
                    title: { display: true, text: 'Your Entered Feature Values', color:'#fff' }
                },
                scales: {
                    x: { ticks: { color:'#fff' } },
                    y: { ticks: { color:'#fff' }, beginAtZero: true }
                }
            }
        });
        </script>
        {% endif %}
    </div>
</div>

<script>
const form = document.getElementById('predictForm');
const inputs = form.querySelectorAll('input[type=number]');

inputs.forEach(input => {
    input.addEventListener('input', () => {
        const min = parseFloat(input.min);
        const max = parseFloat(input.max);
        const value = parseFloat(input.value);
        if (value < min || value > max) {
            input.classList.add('is-invalid');
        } else {
            input.classList.remove('is-invalid');
        }
    });
});
</script>
</body>
</html>  
